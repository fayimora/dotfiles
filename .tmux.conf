set -g default-terminal "screen-256color"
# set -ga terminal-overrides ",alacritty:Tc"


# Ring the bell if any background window rang a bell
set -g bell-action any

set-option -g history-limit 999999

set -g prefix C-a
unbind C-b
bind-key C-a send-prefix

set -g prefix2 `
bind-key ` send-prefix -2

unbind %
bind | split-window -h

unbind '"'
bind - split-window -v

# Alternate session
# Switch between the last 2 tmux sessions, similar to 'cd -' in the terminal
# I use this in combination with the `choose-tree` to sort sessions by time
# Otherwise, by default, sessions are sorted by name, and that makes no sense
# -l stands for `last session`, see `man tmux`
unbind Space
bind-key Space switch-client -l

# When pressing prefix+s to list sessions, I want them sorted by time
# That way my latest used sessions show at the top of the list
# -s starts with sessions collapsed (doesn't show windows)
# -Z zooms the pane
# -O specifies the initial sort field: one of ‘index’, ‘name’, or ‘time’ (activity).
# https://unix.stackexchange.com/questions/608268/how-can-i-force-tmux-to-sort-my-sessions-alphabetically
bind s choose-tree -Zs -O time

# Create splits and vertical splits with V and S
# bind-key v split-window -h -p 50 -c "#{pane_current_path}"
# bind-key ^V split-window -h -p 50 -c "#{pane_current_path}"
# bind-key s split-window -p 50 -c "#{pane_current_path}"
# bind-key ^S split-window -p 50 -c "#{pane_current_path}"

unbind r
bind r source-file ~/.tmux.conf \; display "Reloaded!"

# Detach with ctrl-d
bind-key ^D detach-client

# set first window to index 1 (not 0) to map more to the keyboard layout...
set-option -g base-index 1
set-window-option -g pane-base-index 1
set-window-option -g mouse on

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'christoomey/vim-tmux-navigator'
# set -g @plugin 'aserowy/tmux.nvim'
set -g @plugin 'tmux-plugins/tmux-resurrect' # persist tmux sessions after computer restart
set -g @plugin 'tmux-plugins/tmux-continuum' # automatically saves sessions for you every 15 minutes
# set -g @plugin 'jimeh/tmux-themepack'


# set -g @themepack 'powerline/default/cyan'

set -g @resurrect-capture-pane-contents 'on'
set -g @continuum-restore 'on'

# ── Tokyo Night Status Line ─────────────────────────────────────────
# Colors: bg=#1a1b26, fg=#c0caf5, blue=#7aa2f7, cyan=#7dcfff, purple=#bb9af7, comment=#565f89

set -g status on
set -g status-position bottom
set -g status-style "bg=#1a1b26,fg=#c0caf5"
set -g status-justify left
set -g status-left-length 0
set -g status-right-length 200

# Left (empty - windows appear here naturally)
set -g status-left ""

# Window list
set -g window-status-format "#[fg=#565f89]  #I:#W "
set -g window-status-current-format "#[fg=#7aa2f7,bg=#1a1b26]#[fg=#1a1b26,bg=#7aa2f7,bold] #I:#W #[fg=#7aa2f7,bg=#1a1b26]"
set -g window-status-separator ""

# Right: current command (middle) │ session (far right with powerline)
set -g status-right "#[fg=#7dcfff]  #{pane_current_command} #[fg=#565f89]│ #[fg=#bb9af7,bg=#1a1b26]#[fg=#1a1b26,bg=#bb9af7,bold]  #S #[fg=#bb9af7,bg=#1a1b26]"

# Pane borders (matching theme)
set -g pane-border-style "fg=#565f89"
set -g pane-active-border-style "fg=#7aa2f7"

# Message styling
set -g message-style "bg=#1a1b26,fg=#7aa2f7"

run '~/.tmux/plugins/tpm/tpm'

